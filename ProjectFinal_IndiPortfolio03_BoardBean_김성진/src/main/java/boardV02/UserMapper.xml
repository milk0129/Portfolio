<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="user.UserMapper">
	
  <resultMap id="userResultMap" type="boardV02.UserDTO">
  	<result property="userId" column="USER_ID"/>
	<result property="userName" column="USER_NAME"/>
	<result property="userEmail" column="USER_EMAIL"/>
	<result property="profileImg" column="PROFILE_IMG"/>
  </resultMap>
  
  <!-- 회원가입 -->
  <insert id="insertUser" parameterType="boardV02.UserDTO">
    INSERT INTO BOARD_USERS (USER_ID, USER_PW, USER_NAME, USER_BIRTH, USER_EMAIL)
    VALUES (#{userId}, #{userPw}, #{userName}, #{userBirth}, #{userEmail})
  </insert>

  <!-- 로그인 확인 (boolean용) -->
  <select id="loginCheck" parameterType="boardV02.UserDTO" resultType="int">
    SELECT COUNT(*) FROM BOARD_USERS
    WHERE USER_ID = #{userId} AND USER_PW = #{userPw}
  </select>

  <!-- 아이디 찾기 -->
  <select id="findUserId" parameterType="boardV02.UserDTO" resultType="String">
    SELECT USER_ID FROM BOARD_USERS
    WHERE USER_NAME = #{userName} AND USER_EMAIL = #{userEmail}
  </select>

  <!-- 아이디 중복 확인 -->
  <select id="isUserIdDuplicate" parameterType="String" resultType="int">
    SELECT COUNT(*) FROM BOARD_USERS WHERE USER_ID = #{userId}
  </select>

  <!-- 유저 정보 조회 -->
  <select id="getUser" parameterType="String" resultMap="userResultMap">
    SELECT USER_ID, USER_NAME, USER_EMAIL, PROFILE_IMG
    FROM BOARD_USERS
    WHERE USER_ID = #{userId}
  </select>

  <!-- 회원정보 수정 (비밀번호 포함) -->
  <update id="updateUserWithPw" parameterType="boardV02.UserDTO">
    UPDATE BOARD_USERS
    SET USER_PW = #{userPw}, USER_EMAIL = #{userEmail}, PROFILE_IMG = #{profileImg}
    WHERE USER_ID = #{userId}
  </update>

  <!-- 회원정보 수정 (비밀번호 제외) -->
  <update id="updateUserNoPw" parameterType="boardV02.UserDTO">
    UPDATE BOARD_USERS
    SET USER_EMAIL = #{userEmail}, PROFILE_IMG = #{profileImg}
    WHERE USER_ID = #{userId}
  </update>

  <!-- 회원 탈퇴 -->
  <delete id="deleteUser" parameterType="String">
    DELETE FROM BOARD_USERS WHERE USER_ID = #{userId}
  </delete>

</mapper>
